<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xml:lang=
"en-US">
<head>
<title>Java Remote Method Invocation: 2 - Distributed Object
Model</title>
</head>
<body bgcolor="#FFFFFF">
<a href="#skip" title="Skip navigation bar"></a>
<table width="100%" summary="">
<tr>
<td><a href="rmiTOC.html">CONTENTS</a> | <a href=
"rmi-objmodel6.html">PREV</a> | <a href=
"rmi-objmodel8.html">NEXT</a></td>
<td align="right"><i>Java Remote Method Invocation</i></td>
</tr>
</table>
<br />
<a name="skip" id="skip"></a>
<hr size="8" width="35%" align="left" noshade="noshade" />
<h2><a name="a5112" id="a5112"><i>2.6</i> Parameter Passing in
Remote Method Invocation</a></h2>
<a name="a2537" id="a2537"><!-- --></a> An argument to, or a return
value from, a remote object can be any object that is
<em>serializable</em>. This includes primitive types, remote
objects, and non-remote objects that implement the
<code>java.io.Serializable</code> interface. For more details on
how to make classes serializable, see the &#34;Java Object
Serialization Specification.&#34; Classes, for parameters or return
values, that are not available locally are downloaded dynamically
by the RMI system. See the section on &#34;<a href=
"rmi-arch5.html">Dynamic Class Loading</a>&#34; for more
information on how RMI downloads parameter and return value classes
when reading parameters, return values and exceptions.
<p><br /></p>
<h3><a name="a2523" id="a2523"><!-- --></a> <i>2.6.1</i> Passing
Non-remote Objects</h3>
<a name="a2524" id="a2524"><!-- --></a> A non-remote object, that
is passed as a parameter of a remote method invocation or returned
as a result of a remote method invocation, is passed by
<em>copy</em>; that is, the object is serialized using the object
serialization mechanism of the Java SE platform.
<p><a name="a3655" id="a3655"><!-- --></a> So, when a non-remote
object is passed as an argument or return value in a remote method
invocation, the content of the non-remote object is copied before
invoking the call on the remote object.</p>
<p><a name="a3393" id="a3393"><!-- --></a> When a non-remote object
is returned from a remote method invocation, a new object is
created in the calling virtual machine.</p>
<p><br /></p>
<h3><a name="a3404" id="a3404"><!-- --></a> <i>2.6.2</i> Passing
Remote Objects</h3>
<a name="a3728" id="a3728"><!-- --></a> When passing an exported
remote object as a parameter or return value in a remote method
call, the stub for that remote object is passed instead. Remote
objects that are not exported will not be replaced with a stub
instance. A remote object passed as a parameter can only implement
remote interfaces.
<p><br /></p>
<h3><a name="a4716" id="a4716"><!-- --></a> <i>2.6.3</i>
Referential Integrity</h3>
<a name="a4792" id="a4792"><!-- --></a> If two references to an
object are passed from one JVM to another JVM in parameters (or in
the return value) in a single remote method call and those
references refer to the same object in the sending JVM, those
references will refer to a single copy of the object in the
receiving JVM. More generally stated: within a single remote method
call, the RMI system maintains referential integrity among the
objects passed as parameters or as a return value in the call.
<p><br /></p>
<h3><a name="a4795" id="a4795"><!-- --></a> <i>2.6.4</i> Class
Annotation</h3>
<a name="a4796" id="a4796"><!-- --></a> When an object is sent from
one JVM to another in a remote method call, the RMI system
annotates the class descriptor in the call stream with information
(the URL) of the class so that the class can be loaded at the
receiver. It is a requirement that classes be downloaded on demand
during remote method invocation.
<p><br /></p>
<h3><a name="a4941" id="a4941"><!-- --></a> <i>2.6.5</i> Parameter
Transmission</h3>
<a name="a4947" id="a4947"><!-- --></a> Parameters in an RMI call
are written to a stream that is a subclass of the class
<code>java.io.ObjectOutputStream</code> in order to serialize the
parameters to the destination of the remote call. The
<code>ObjectOutputStream</code> subclass overrides the
<code>replaceObject</code> method to replace each exported remote
object with its corresponding stub instance. Parameters that are
objects are written to the stream using the
<code>ObjectOutputStream</code>&#39;s <code>writeObject</code>
method. The <code>ObjectOutputStream</code> calls the
<code>replaceObject</code> method for each object written to the
stream via the <code>writeObject</code> method (that includes
objects referenced by those objects that are written). The
<code>replaceObject</code> method of RMI&#39;s subclass of
<code>ObjectOutputStream</code> returns the following:
<ul>
<li><a name="a4977" id="a4977"><!-- --></a> If the object passed to
<code>replaceObject</code> is an instance of
<code>java.rmi.Remote</code> and that object is exported to the RMI
runtime, then it returns the stub for the remote object. If the
object is an instance of <code>java.rmi.Remote</code> and the
object is <em>not</em> exported to the RMI runtime, then
<code>replaceObject</code> returns the object itself. A stub for a
remote object is obtained via a call to the method
<code>java.rmi.server.RemoteObject.toStub</code>.</li>
<li><a name="a4980" id="a4980"><!-- --></a> If the object passed to
<code>replaceObject</code> is not an instance of
<code>java.rmi.Remote</code>, then the object is simply
returned.</li>
</ul>
<a name="a4981" id="a4981"><!-- --></a> RMI&#39;s subclass of
<code>ObjectOutputStream</code> also implements the
<code>annotateClass</code> method that annotates the call stream
with the location of the class so that it can be downloaded at the
receiver. See the section &#34;<a href="rmi-arch5.html">Dynamic
Class Loading</a>&#34; for more information on how
<code>annotateClass</code> is used.
<p><a name="a4985" id="a4985"><!-- --></a> Since parameters are
written to a single <code>ObjectOutputStream</code>, references
that refer to the same object at the caller will refer to the same
copy of the object at the receiver. At the receiver, parameters are
read by a single <code>ObjectInputStream</code>.</p>
<p><a name="a4996" id="a4996"><!-- --></a> Any other default
behavior of <code>ObjectOutputStream</code> for writing objects
(and similarly <code>ObjectInputStream</code> for reading objects)
is maintained in parameter passing. For example, the calling of
<code>writeReplace</code> when writing objects and
<code>readResolve</code> when reading objects is honored by
RMI&#39;s parameter marshal and unmarshal streams.</p>
<p><a name="a4990" id="a4990"><!-- --></a> In a similar manner to
parameter passing in RMI as described above, a return value (or
exception) is written to a subclass of
<code>ObjectOutputStream</code> and has the same replacement
behavior as parameter transmission.</p>
<p><br /></p>
<hr />
<a href="rmiTOC.html">CONTENTS</a> | <a href=
"rmi-objmodel6.html">PREV</a> | <a href=
"rmi-objmodel8.html">NEXT</a>
<hr />
Copyright 1997, 2010, Oracle and/or its affiliates. All rights
reserved.
</body>
</html>
